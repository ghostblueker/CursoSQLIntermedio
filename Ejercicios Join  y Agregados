/* Ejercicios Join y agregados */

1º Según la tabla de ventas actual ¿Cuáles han sido los importes de venta totales? ¿Y el total de productos vendidos?
	SELECT SUM(IMPORTE_VENTA) AS IMPORTE_TOTAL 
	FROM DBO.FACT_VENTAS

	SELECT SUM(UNIDADES) AS PRODUCTOS_VENDIDOS 
	FROM DBO.FACT_VENTAS
2º Mostrar todos los importes de venta con el nombre del artículo y su fecha de venta.
	SELECT NOMBRE_ARTICULO,ID_DIA,IMPORTE_VENTA
	FROM DBO.FACT_VENTAS V
		INNER JOIN DBO.LKP_ARTICULO A
			ON A.ID_ARTICULO = V.ID_ARTICULO
3º Extraer los datos de los socios ordenados de mayor a menor margen obtenido.
	SELECT NOMBRE_SOCIO,sum(MARGEN)
	FROM DBO.FACT_VENTAS V
		INNER JOIN DBO.LKP_SOCIO s
			ON s.ID_SOCIO = V.ID_SOCIO
	group by NOMBRE_SOCIO
4º Mostrar los socios con sus tiendas correspondientes.
	select nombre_tienda,cod_socio,NOMBRE_SOCIO 
	from dbo.LKP_TIENDAS t
	inner join dbo.LKP_SOCIO s
		on t.ID_SOCIO=s.ID_SOCIO
5º Localizar los proveedores de los cuales más productos se han vendido.
	select NOMBRE_PROVEEDOR,sum(unidades)
	from dbo.LKP_PROVEEDOR p
		inner join dbo.LKP_MARCA m
		on p.ID_PROVEEDOR=m.ID_PROVEEDOR
			inner join dbo.LKP_ARTICULO a
			on a.ID_MARCA=m.ID_MARCA
				inner join dbo.FACT_VENTAS v
				on v.ID_ARTICULO=a.ID_ARTICULO
	group by NOMBRE_PROVEEDOR
	order by 2 desc
6º Mostrar las marcas más vendidas.
	select NOMBRE_MARCA,sum(unidades)
	from dbo.LKP_MARCA m
			inner join dbo.LKP_ARTICULO a
			on a.ID_MARCA=m.ID_MARCA
				inner join dbo.FACT_VENTAS v
				on v.ID_ARTICULO=a.ID_ARTICULO
	group by NOMBRE_MARCA
	order by 2 desc
7º Extraer aquellos registros para los que no disponemos de referencias en las tablas de socio, tiendas, marcas o proveedores.
	SELECT A.ID_ARTICULO, M.ID_MARCA
	, P.ID_PROVEEDOR, S.ID_SOCIO, T.ID_TIENDA, V.*
	FROM DBO.FACT_VENTAS V
		LEFT JOIN DBO.lkp_ARTICULO A
			ON A.ID_ARTICULO = V.ID_ARTICULO
		LEFT JOIN DBO.LKP_MARCA M
			ON A.ID_MARCA = M.ID_MARCA
		LEFT JOIN DBO.LKP_PROVEEDOR P
			ON P.ID_PROVEEDOR = M.ID_PROVEEDOR
		LEFT JOIN DBO.LKP_SOCIO S
			ON S.ID_SOCIO = V.ID_SOCIO
		LEFT JOIN DBO.LKP_TIENDAS T
			ON T.ID_TIENDA = V.ID_TIENDA
	WHERE A.ID_ARTICULO IS NULL 
		OR M.ID_MARCA IS NULL
		OR P.ID_PROVEEDOR IS NULL
		OR S.ID_SOCIO IS NULL
		OR T.ID_TIENDA IS NULL
